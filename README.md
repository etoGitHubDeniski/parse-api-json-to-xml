# Parse neometria

Команда для парсинга - ```php artisan parse:neometria```

## !Внимание. Итоговый код парсит сразу все 4520, это может занять несколько минут.

Файлы:
- /app/Components/ParseDataClient.php - Клиент
- /app/Console/Commands/ParseNeometriaCommand.php - Консольная команда
- /output.xml - Сгенерированный xml файл

Материалы:
- [Документация Laravel. HTTP Client](https://laravel.com/docs/10.x/http-client)
- [Документация Guzzle](https://docs.guzzlephp.org/en/stable/)

- [YouTube. Как спарсить посты c jsonplaceholder API в свою базу данных ](https://www.youtube.com/watch?v=DFCkTkmb2yo&ab_channel=LaravelCreative)

Так как у API лимит в 20 элементов, для парсинга всего сайта использую цикл `for`. Однако сейчас я думаю что для этого лучше подойдет `while (true)`, еслибы я не знал сколько всего элементов на сайте.

API нашел не сразу. Запрос появился только после того как загрузил 20 следующих элементов (видимо первые 20 хранятся в самом сайте или что-то ещё).

Главная трудность состояла в группировке данных. К счастью построчный дампинг массива и гугл мне с этим помогли. Изначально я думал что придется отдельно парсить /api/projects/, отдельно /api/buildings/, отдельно /api/flats/. Но позже всё получилось (кроме `project_id`, на всякий случай я заменил это поле на `project_slug`).

Также готов к предложениям по улучшению функционала сервиса, оптимизации, чистоте кода и тп.
